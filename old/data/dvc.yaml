stages:

    make_dc_incident_geojson:
        cmd: python prepare_incident_geojson.py
        deps:
            - prepare_incident_geojson.py
            - Crashes_in_DC.csv
        outs:
            - dcincidents.json
    
    make_dc_intersection_graph:
        cmd: python prepare_osm_graph.py "District of Columbia"
        deps:
            - prepare_osm_graph.py
        outs:
            - DistrictofColumbia.graphml
    
    make_dc_intersection_geojson:
        cmd: python prepare_osm_intersections.py "District of Columbia"
        deps:
            - prepare_osm_intersections.py
            - DistrictofColumbia.graphml
        outs:
            - dc_intersections.json

    make_dc_intersection_masks:
        cmd: python prepare_intersection_masks.py "dc_intersections.json" "District of Columbia"
        deps:
            - dc_intersections.json
            - prepare_intersection_masks.py
        outs:
            - masks
    make_intersection_accidents:
        cmd: python integration.py
        deps:
            - US_Accidents_June20.tar
            - integration.py
        outs:
            - intersection_accidents.json
            - intersection_accidents.pkl
